//This project is licensed under the terms of the Creative Commons CC BY-NC-ND 4.0 license.

//Contains the coefficients of sixth order derivative, dissipation and divergence cleaning operators

//------------------------------------------------------------------------------
// Derivative and Dissipation Operators
//------------------------------------------------------------------------------

#define ORDER 6
#define NUM_BOUNDS 6
#define STENCIL_WIDTH 11
#define STENCIL_WIDTH_HOD 4

/*
Coefficients of the first derivative operator.

For each row, the central coefficient corresponds to the nodes at which the
derivative is computed.
*/
REAL constant SBP_diff[2*NUM_BOUNDS+1][STENCIL_WIDTH] = {
  // left boundary coefficients
  {0.0, 0.0, 0.0, 0.0, 0.0, -1.5825335189391163, 1.905066305223826, 0.3717366351625272, -1.2202725474393727, 0.6177375631914426, -0.09173443719930642},
  {0.0, 0.0, 0.0, 0.0, -0.4329018563223175, 0.0, -0.0043147701101584396, 0.8419628735536502, -0.5064721551652377, 0.10172590804406338, 0.0},
  {0.0, 0.0, 0.0, -0.1871572605434649, 0.009559818025328907, 0.0, -0.6857863027173244, 1.2691196360506578, -0.40573589081519734, 0.0, 0.0},
  {0.0, 0.0, 0.31079492442619894, -0.9436928531442433, 0.3469241773962804, 0.0, 0.19345960067176712, 0.0790788082353673, 0.013435342414629596, 0.0, 0.0},
  {0.0, -0.21407896407261648, 0.772407007744065, -0.8735770809529855, -0.26323473403580044, 0.0, 0.7247323431086286, -0.1645296432652025, 0.01828107147391139, 0.0, 0.0},
  {0.02858572483124434, -0.1394983371764724, 0.2511244035524303, -0.09675197674330115, -0.6516651065805195, 0.0, 0.7397091390607521, -0.1479418278121504, 0.016437980868016712, 0.0, 0.0},
  // central coefficients
  {0.0, 0.0, -0.016666666666666666, 0.15, -0.75, 0.0, 0.75, -0.15, 0.016666666666666666, 0.0, 0.0},
  // right boundary coefficients
  {0.0, 0.0, -0.016437980868016712, 0.1479418278121504, -0.7397091390607521, 0.0, 0.6516651065805195, 0.09675197674330115,-0.2511244035524303, 0.1394983371764724, -0.02858572483124434},
  {0.0, 0.0, -0.01828107147391139, 0.1645296432652025, -0.7247323431086286, 0.0, 0.26323473403580044, 0.8735770809529855, -0.772407007744065, 0.21407896407261648, 0.0},
  {0.0, 0.0, -0.013435342414629596, -0.0790788082353673, -0.19345960067176712, 0.0, -0.3469241773962804, 0.9436928531442433, -0.31079492442619894, 0.0, 0.0},
  {0.0, 0.0, 0.40573589081519734, -1.2691196360506578, 0.6857863027173244, 0.0, -0.009559818025328907, 0.1871572605434649,0.0, 0.0, 0.0},
  {0.0, -0.10172590804406338, 0.5064721551652377, -0.8419628735536502, 0.0043147701101584396, 0.0, 0.4329018563223175, 0.0, 0.0, 0.0, 0.0},
  {0.09173443719930642, -0.6177375631914426, 1.2202725474393727, -0.3717366351625272, -1.905066305223826, 1.5825335189391163, 0.0, 0.0, 0.0, 0.0, 0.0}
};


/*
Coefficients of the inverse mass/norm matrix.


The central coefficient corresponds to the inner nodes of the grid and is 1.
*/
REAL constant M_INV[2*NUM_BOUNDS+1] = {
  // left boundary coefficients
  3.1650670378782326,
  0.719220844085574,
  1.5935079306528956,
  0.8061205448777757,
  1.0968642884346833,
  0.9862788520810027,
  // central coefficients
  1.0,
  // right boundary coefficients
  0.9862788520810027,
  1.0968642884346833,
  0.8061205448777757,
  1.5935079306528956,
  0.719220844085574,
  3.1650670378782326
};


/*
Coeffcients of the high-order dissipation operator.

TODO: Explanation...
*/
REAL constant D_HO[2*NUM_BOUNDS+1][STENCIL_WIDTH_HOD] = {
  // left boundary coefficients
  {0.0,  0.0, 3.0, -1.0},
  {0.0, -3.0, 3.0, -1.0},
  {1.0, -3.0, 3.0, -1.0},
  {1.0, -3.0, 3.0, -1.0},
  {1.0, -3.0, 3.0, -1.0},
  {1.0, -3.0, 3.0, -1.0},
  // central coefficients
  {1.0, -3.0, 3.0, -1.0},
  // right boundary coefficients
  {1.0, -3.0, 3.0, -1.0},
  {1.0, -3.0, 3.0, -1.0},
  {1.0, -3.0, 3.0, -1.0},
  {1.0, -3.0, 3.0, -1.0},
  {1.0, -3.0, 3.0,  0.0},
  {1.0, -3.0, 0.0,  0.0},
};


//------------------------------------------------------------------------------
// Divergence Cleaning Operators
//------------------------------------------------------------------------------

// coefficients for the wide stencil operator using homogeneous Dirichlet boundary conditions
#define NUM_BOUNDS_LAPLACE_WS_D0 9
#define STENCIL_WIDTH_LAPLACE_WS_D0 15

REAL constant SBP_minus_laplace_WS_D0[2*NUM_BOUNDS_LAPLACE_WS_D0+1][STENCIL_WIDTH_LAPLACE_WS_D0] = {
  // left boundary coefficients
  {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0},
  {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0246955716477197, -0.599160122757549, -0.6546961416187781, 0.1763011207068389, 0.2590126658665609, -0.16988932637914095, 0.024308370440011117, -0.0016721685302099412},
  {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.3275010244718624, 1.518094318259612, 0.058388741432927965, -0.01127612656178464, -0.8836821311302195, 0.5181481212615053, -0.08322617607177786, 0.006669478810687931, 0.0},
  {0.0, 0.0, 0.0, 0.0, 0.0, -0.7337996593829428, 0.029537577537724895, 1.4705249494043575, -1.0607145395328803, 0.1351382771579016, -0.026665478072979476, -0.0019140921666203567, 0.0007154054253559093, -0.00022392237357715992, 0.0},
  {0.0, 0.0, 0.0, 0.0, 0.26887207858972395, -0.007761731397485885, -1.4432827770361065, 2.1803132836729686, -0.5579768967802579,-0.5188436851777367, 0.2306154599629749, -0.05030338648566647, 0.005484321442173416, -0.0003046845245651898, 0.0},
  {0.0, 0.0, 0.0, 0.3551881412587608, -0.546942366040507, 0.16534006695947462, -0.5017218803153, 1.1758839794247196, -0.2193403995665498, -0.530540232254099, 0.22191274171822561, -0.04684824547384763, 0.004931394260405014, -0.00027396634780027854, 0.0},
  {0.0, 0.0, -0.23621301826303476, 0.3251619344305419, -0.03307877245210579, -0.4730245032575268, -0.22239187132903815, 1.1649630009366994, -0.2286985315801995, -0.5376715143489874, 0.225, -0.0475, 0.005, -0.0002777777777777778, 0.0},
  {0.0, 0.03379820070553861, -0.05222827854874764, -0.002374449055768169, 0.21024976598707792, -0.5379211276148562, -0.2286985315801995, 1.1702737364741655, -0.2299656971302025, -0.5375, 0.225, -0.0475, 0.005, -0.0002777777777777778, 0.0},
  {-0.0023249722862745395, 0.0041854067258738385, 0.0008874670542783143, -0.04586108510967533, 0.225, -0.5376715143489874, -0.2299656971302025, 1.1705517441255782, -0.23, -0.5375, 0.225, -0.0475, 0.005, -0.0002777777777777778, 0.0},
  // central coefficients
  {0.0, -0.0002777777777777778, 0.005, -0.0475, 0.225, -0.5375, -0.23, 1.1705555555555556, -0.23, -0.5375, 0.225, -0.0475, 0.005, -0.0002777777777777778, 0.0},
  // right boundary coefficients
  {0.0, -0.0002777777777777778, 0.005, -0.0475, 0.225, -0.5375, -0.23, 1.1705517441255782, -0.2299656971302025, -0.5376715143489874, 0.225, -0.04586108510967533, 0.0008874670542783143, 0.0041854067258738385, -0.0023249722862745395},
  {0.0, -0.0002777777777777778, 0.005, -0.0475, 0.225, -0.5375, -0.2299656971302025, 1.1702737364741655, -0.2286985315801995, -0.5379211276148562, 0.21024976598707792, -0.002374449055768169, -0.05222827854874764, 0.03379820070553861, 0.0},
  {0.0, -0.0002777777777777778, 0.005, -0.0475, 0.225, -0.5376715143489874, -0.2286985315801995, 1.1649630009366994, -0.22239187132903815, -0.4730245032575268, -0.03307877245210579, 0.3251619344305419, -0.23621301826303476, 0.0, 0.0},
  {0.0, -0.00027396634780027854, 0.004931394260405014, -0.04684824547384763, 0.22191274171822561, -0.530540232254099, -0.2193403995665498, 1.1758839794247196, -0.5017218803153, 0.16534006695947462, -0.546942366040507, 0.3551881412587608, 0.0, 0.0, 0.0},
  {0.0, -0.0003046845245651898, 0.005484321442173416, -0.05030338648566647, 0.2306154599629749, -0.5188436851777367, -0.5579768967802579, 2.1803132836729686, -1.4432827770361065, -0.007761731397485885, 0.26887207858972395, 0.0, 0.0, 0.0, 0.0},
  {0.0, -0.00022392237357715992, 0.0007154054253559093, -0.0019140921666203567, -0.026665478072979476, 0.1351382771579016, -1.0607145395328803, 1.4705249494043575, 0.029537577537724895, -0.7337996593829428, 0.0, 0.0, 0.0, 0.0, 0.0},
  {0.0, 0.006669478810687931, -0.08322617607177786, 0.5181481212615053, -0.8836821311302195, -0.01127612656178464, 0.058388741432927965, 1.518094318259612, -1.3275010244718624, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0},
  {-0.0016721685302099412, 0.024308370440011117, -0.16988932637914095, 0.2590126658665609, 0.1763011207068389, -0.6546961416187781, -0.599160122757549, 2.0246955716477197, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0},
  {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}
};

// coefficients for the narrow stencil operator using homogeneous Dirichlet boundary conditions
#define NUM_BOUNDS_LAPLACE_NS_D0 6
#define STENCIL_WIDTH_LAPLACE_NS_D0 9

REAL constant SBP_minus_laplace_NS_D0[2*NUM_BOUNDS_LAPLACE_NS_D0+1][STENCIL_WIDTH_LAPLACE_NS_D0] = {
  // left boundary coefficients
  {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0},
  {0.0, 0.0, 0.0, 0.0, 2.3503981797497158, -1.8674630261660978, 1.0341296928327646, -0.6003981797497155, 0.13674630261660978},
  {0.0, 0.0, 0.0, -4.137556867084717, 8.108447067502766, -6.9417804008361, 2.8875568670847165, -0.5608447067502766, 0.0},
  {0.0, 0.0, 1.159078186228774, -3.511693723953474, 4.7231448653355725, -2.4896902407165515, 0.3414753996392362, -0.008956894943086397, 0.0},
  {0.0, -0.9156510515847827, 1.987601032542, -3.3876475815665863, 3.7198595065803395, -1.7355824975667555, 0.1645296432652025, -0.012187380982607592, 0.0},
  {0.18752235489296287, -0.34712677792744456, 0.41779107021909695, -1.560601736642238, 2.68487020844273, -1.4794182781215042,0.1479418278121504, -0.01095865391201114, 0.0},
  // central coefficients
  {0.0, -0.011111111111111112, 0.15, -1.5, 2.7222222222222223, -1.5, 0.15, -0.011111111111111112, 0.0},
  // right boundary coefficients
  {0.0, -0.01095865391201114, 0.1479418278121504, -1.4794182781215042, 2.68487020844273, -1.560601736642238, 0.41779107021909695, -0.34712677792744456, 0.18752235489296287},
  {0.0, -0.012187380982607592, 0.1645296432652025, -1.7355824975667555, 3.7198595065803395, -3.3876475815665863, 1.987601032542, -0.9156510515847827, 0.0},
  {0.0, -0.008956894943086397, 0.3414753996392362, -2.4896902407165515, 4.7231448653355725, -3.511693723953474, 1.159078186228774, 0.0, 0.0},
  {0.0, -0.5608447067502766, 2.8875568670847165, -6.9417804008361, 8.108447067502766, -4.137556867084717, 0.0, 0.0, 0.0},
  {0.13674630261660978, -0.6003981797497155, 1.0341296928327646, -1.8674630261660978, 2.3503981797497158, 0.0, 0.0, 0.0, 0.0},
  {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}
};

// coefficients for the wide stencil operator using the least norm solution
#define NUM_BOUNDS_LAPLACE_WS_LN 9
#define STENCIL_WIDTH_LAPLACE_WS_LN 17

REAL constant SBP_minus_laplace_WS_LN[2*NUM_BOUNDS_LAPLACE_WS_LN+1][STENCIL_WIDTH_LAPLACE_WS_LN] = {
  // left boundary coefficients
  {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.91281371593186, 1.3697734431191093, 1.5825257913083428, -3.1264509215916743, 1.6469684818172043, -0.5393372194997557, 0.18588772198034542, -0.02486426485740693, 0.0015079289236204795},
  {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.3112634267066132, 2.0246955716477197, -0.599160122757549, -0.6546961416187781, 0.1763011207068389, 0.2590126658665609, -0.16988932637914095, 0.024308370440011117, -0.0016721685302099412, 0.0},
  {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.7967500747166201, -1.3275010244718624, 1.518094318259612, 0.058388741432927965, -0.01127612656178464, -0.8836821311302195, 0.5181481212615053, -0.08322617607177786, 0.006669478810687931, 0.0, 0.0},
  {0.0, 0.0, 0.0, 0.0, 0.0, -0.7962852888375586, -0.7337996593829428, 0.029537577537724895, 1.4705249494043575, -1.0607145395328803, 0.1351382771579016, -0.026665478072979476, -0.0019140921666203567, 0.0007154054253559093, -0.00022392237357715992, 0.0, 0.0},
  {0.0, 0.0, 0.0, 0.0, 0.5707622904233344, 0.26887207858972395, -0.007761731397485885, -1.4432827770361065, 2.1803132836729686, -0.5579768967802579, -0.5188436851777367, 0.2306154599629749, -0.05030338648566647, 0.005484321442173416, -0.0003046845245651898, 0.0, 0.0},
  {0.0, 0.0, 0.0, -0.16806496904071058, 0.3551881412587608, -0.546942366040507, 0.16534006695947462, -0.5017218803153, 1.1758839794247196, -0.2193403995665498, -0.530540232254099, 0.22191274171822561, -0.04684824547384763, 0.004931394260405014, -0.00027396634780027854, 0.0, 0.0},
  {0.0, 0.0, 0.05873105364142904, -0.23621301826303476, 0.3251619344305419, -0.03307877245210579, -0.4730245032575268, -0.22239187132903815, 1.1649630009366994, -0.2286985315801995, -0.5376715143489874, 0.225, -0.0475, 0.005, -0.0002777777777777778, 0.0, 0.0},
  {0.0, -0.007855841459230259, 0.03379820070553861, -0.05222827854874764, -0.002374449055768169, 0.21024976598707792, -0.5379211276148562, -0.2286985315801995, 1.1702737364741655, -0.2299656971302025, -0.5375, 0.225, -0.0475, 0.005, -0.0002777777777777778, 0.0, 0.0},
  {0.0004764287471874057, -0.0023249722862745395, 0.0041854067258738385, 0.0008874670542783143, -0.04586108510967533, 0.225, -0.5376715143489874, -0.2299656971302025, 1.1705517441255782, -0.23, -0.5375, 0.225, -0.0475, 0.005, -0.0002777777777777778, 0.0, 0.0},
  // central coefficients
  {0.0, 0.0, -0.0002777777777777778, 0.005, -0.0475, 0.225, -0.5375, -0.23, 1.1705555555555556, -0.23, -0.5375, 0.225, -0.0475, 0.005, -0.0002777777777777778, 0.0, 0.0},
  // right boundary coefficients
  {0.0, 0.0, -0.0002777777777777778, 0.005, -0.0475, 0.225, -0.5375, -0.23, 1.1705517441255782, -0.2299656971302025, -0.5376715143489874, 0.225, -0.04586108510967533, 0.0008874670542783143, 0.0041854067258738385, -0.0023249722862745395, 0.0004764287471874057},
  {0.0, 0.0, -0.0002777777777777778, 0.005, -0.0475, 0.225, -0.5375, -0.2299656971302025, 1.1702737364741655, -0.2286985315801995, -0.5379211276148562, 0.21024976598707792, -0.002374449055768169, -0.05222827854874764, 0.03379820070553861, -0.007855841459230259, 0.0},
  {0.0, 0.0, -0.0002777777777777778, 0.005, -0.0475, 0.225, -0.5376715143489874, -0.2286985315801995, 1.1649630009366994, -0.22239187132903815, -0.4730245032575268, -0.03307877245210579, 0.3251619344305419, -0.23621301826303476, 0.05873105364142904, 0.0, 0.0},
  {0.0, 0.0, -0.00027396634780027854, 0.004931394260405014, -0.04684824547384763, 0.22191274171822561, -0.530540232254099, -0.2193403995665498, 1.1758839794247196, -0.5017218803153, 0.16534006695947462, -0.546942366040507, 0.3551881412587608, -0.16806496904071058, 0.0, 0.0, 0.0},
  {0.0, 0.0, -0.0003046845245651898, 0.005484321442173416, -0.05030338648566647, 0.2306154599629749, -0.5188436851777367, -0.5579768967802579, 2.1803132836729686, -1.4432827770361065, -0.007761731397485885, 0.26887207858972395, 0.5707622904233344, 0.0, 0.0, 0.0, 0.0},
  {0.0, 0.0, -0.00022392237357715992, 0.0007154054253559093, -0.0019140921666203567, -0.026665478072979476, 0.1351382771579016, -1.0607145395328803, 1.4705249494043575, 0.029537577537724895, -0.7337996593829428, -0.7962852888375586, 0.0, 0.0, 0.0, 0.0, 0.0},
  {0.0, 0.0, 0.006669478810687931, -0.08322617607177786, 0.5181481212615053, -0.8836821311302195, -0.01127612656178464, 0.058388741432927965, 1.518094318259612, -1.3275010244718624, 0.7967500747166201, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0},
  {0.0, -0.0016721685302099412, 0.024308370440011117, -0.16988932637914095, 0.2590126658665609, 0.1763011207068389, -0.6546961416187781, -0.599160122757549, 2.0246955716477197, 0.3112634267066132, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0},
  {0.0015079289236204795, -0.02486426485740693, 0.18588772198034542, -0.5393372194997557, 1.6469684818172043, -3.1264509215916743, 1.5825257913083428, 1.3697734431191093, 3.91281371593186, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}
};

REAL constant SBP_diff_adjoint[2*NUM_BOUNDS+1][STENCIL_WIDTH] = {
  // left boundary coefficients
  {0.0, 0.0, 0.0, 0.0, 0.0, -1.5825335189391163, -1.905066305223826, -0.3717366351625272, 1.2202725474393727, -0.6177375631914426, 0.09173443719930642},
  {0.0, 0.0, 0.0, 0.0, 0.4329018563223175, 0.0, 0.0043147701101584396, -0.8419628735536502, 0.5064721551652377, -0.10172590804406338, 0.0},
  {0.0, 0.0, 0.0, 0.1871572605434649, -0.009559818025328907, 0.0, 0.6857863027173244, -1.2691196360506578, 0.40573589081519734, 0.0, 0.0},
  {0.0, 0.0, -0.31079492442619894, 0.9436928531442433, -0.3469241773962804, 0.0, -0.19345960067176712, -0.0790788082353673, -0.013435342414629596, 0.0, 0.0},
  {0.0, 0.21407896407261648, -0.772407007744065, 0.8735770809529855, 0.26323473403580044, 0.0, -0.7247323431086286, 0.1645296432652025, -0.01828107147391139, 0.0, 0.0},
  {-0.02858572483124434, 0.1394983371764724, -0.2511244035524303, 0.09675197674330115, 0.6516651065805195, 0.0, -0.7397091390607521, 0.1479418278121504, -0.016437980868016712, 0.0, 0.0},
  // central coefficients
  {0.0, 0.0, 0.016666666666666666, -0.15, 0.75, 0.0, -0.75, 0.15, -0.016666666666666666, 0.0, 0.0},
  // right boundary coefficients
  {0.0, 0.0, 0.016437980868016712, -0.1479418278121504, 0.7397091390607521, 0.0, -0.6516651065805195, -0.09675197674330115, 0.2511244035524303, -0.1394983371764724, 0.02858572483124434},
  {0.0, 0.0, 0.01828107147391139, -0.1645296432652025, 0.7247323431086286, 0.0, -0.26323473403580044, -0.8735770809529855, 0.772407007744065, -0.21407896407261648, 0.0},
  {0.0, 0.0, 0.013435342414629596, 0.0790788082353673, 0.19345960067176712, 0.0, 0.3469241773962804, -0.9436928531442433, 0.31079492442619894, 0.0, 0.0},
  {0.0, 0.0, -0.40573589081519734, 1.2691196360506578, -0.6857863027173244, 0.0, 0.009559818025328907, -0.1871572605434649, 0.0, 0.0, 0.0},
  {0.0, 0.10172590804406338, -0.5064721551652377, 0.8419628735536502, -0.0043147701101584396, 0.0, -0.4329018563223175, 0.0, 0.0, 0.0, 0.0},
  {-0.09173443719930642, 0.6177375631914426, -1.2202725474393727, 0.3717366351625272, 1.905066305223826, 1.5825335189391163, 0.0, 0.0, 0.0, 0.0, 0.0}
};
