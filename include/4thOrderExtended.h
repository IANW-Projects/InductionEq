//This project is licensed under the terms of the Creative Commons CC BY-NC-ND 4.0 license.

//------------------------------------------------------------------------------
// Derivative and Dissipation Operators
//------------------------------------------------------------------------------

#define ORDER 4
#define NUM_BOUNDS 6
#define STENCIL_WIDTH 11
#define STENCIL_WIDTH_HOD 3 //Stencil width for high order dissipation (HOD)

/*
Coefficients of the first derivative operator.

For each row, the central coefficient corresponds to the nodes at which the
derivative is computed.
*/
REAL constant SBP_diff[2*NUM_BOUNDS+1][STENCIL_WIDTH] = {
  // left boundary coefficients
  {0.0, 0.0, 0.0, 0.0, 0.0, -1.5655577299412915, 2.006698028441886, -0.17969802499047988, -0.34551679626695936, 0.031124203444273024, 0.05295031931257198},
  {0.0, 0.0, 0.0, 0.0, -0.4648100847546831, 0.0, 0.31822112431530714, 0.19343747460090951, -0.01748789837432497, -0.029360615787208586, 0.0},
  {0.0, 0.0, 0.0, 0.08895922679561, -0.680116299599615, 0.0, 0.6911055296415899, -0.10654199486276988, 0.006593538025184958, 0.0, 0.0},
  {0.0, 0.0, 0.09023462498760625, -0.21809773186831677, -0.3645866195553873, 0.0, 0.5149776612013978, -0.0225279347652999, 0.0, 0.0, 0.0},
  {0.0, -0.010766469472750029, 0.026116752329614308, 0.07444717053592571, -0.6821178348068156, 0.0, 0.6825798774651727, -0.09025949605114705, 0.0, 0.0, 0.0},
  {-0.016735517732012817, 0.040062884094222144, -0.004209605405399509, 0.02726389466132439, -0.6236615676516715, 0.0, 0.6597484708954711, -0.08246855886193388, 0.0, 0.0, 0.0},
  // central coefficients
  {0.0, 0.0, 0.0, 0.08333333333333333, -0.6666666666666666, 0.0, 0.6666666666666666, -0.08333333333333333, 0.0, 0.0, 0.0},
  // right boundary coefficients
  {0.0, 0.0, 0.0, 0.08246855886193388, -0.6597484708954711, 0.0, 0.6236615676516715, -0.02726389466132439, 0.004209605405399509,-0.040062884094222144, 0.016735517732012817},
  {0.0, 0.0, 0.0, 0.09025949605114705, -0.6825798774651727, 0.0, 0.6821178348068156, -0.07444717053592571, -0.026116752329614308, 0.010766469472750029, 0.0},
  {0.0, 0.0, 0.0, 0.0225279347652999, -0.5149776612013978, 0.0, 0.3645866195553873, 0.21809773186831677, -0.09023462498760625, 0.0, 0.0},
  {0.0, 0.0, -0.006593538025184958, 0.10654199486276988, -0.6911055296415899, 0.0, 0.680116299599615, -0.08895922679561, 0.0, 0.0, 0.0},
  {0.0, 0.029360615787208586, 0.01748789837432497, -0.19343747460090951, -0.31822112431530714, 0.0, 0.4648100847546831, 0.0, 0.0, 0.0, 0.0},
  {-0.05295031931257198, -0.031124203444273024, 0.34551679626695936, 0.17969802499047988, -2.006698028441886, 1.5655577299412915, 0.0, 0.0, 0.0, 0.0, 0.0}
};


/*
Coefficients of the inverse mass/norm matrix.


The central coefficient corresponds to the inner nodes of the grid and is 1.
*/
REAL constant M_INV[2*NUM_BOUNDS+1] = {
  // left boundary coefficients
  3.131115459882583,
  0.725258121380005,
  1.55005382131324,
  0.817717206132879,
  1.0831139526137645,
  0.9896227063432067,
  // central coefficients
  1.0,
  // right boundary coefficients
  0.9896227063432067,
  1.0831139526137645,
  0.817717206132879,
  1.55005382131324,
  0.725258121380005,
  3.131115459882583
};


/*
Coeffcients of the high-order dissipation operator.

TODO: Explanation...
*/
REAL constant D_HO[2*NUM_BOUNDS+1][STENCIL_WIDTH_HOD] = {
  // left boundary coefficients
  { 0.0, 0.0, -1.0},
  { 0.0, 2.0, -1.0},
  {-1.0, 2.0, -1.0},
  {-1.0, 2.0, -1.0},
  {-1.0, 2.0, -1.0},
  {-1.0, 2.0, -1.0},
  // central coefficients
  {-1.0, 2.0, -1.0},
  // right boundary coefficients
  {-1.0, 2.0, -1.0},
  {-1.0, 2.0, -1.0},
  {-1.0, 2.0, -1.0},
  {-1.0, 2.0, -1.0},
  {-1.0, 2.0,  0.0},
  {-1.0, 0.0,  0.0}
};



//------------------------------------------------------------------------------
// Divergence Cleaning Operators
//------------------------------------------------------------------------------

// coefficients for the wide stencil operator using homogeneous Dirichlet boundary conditions
#define NUM_BOUNDS_LAPLACE_WS_D0 8
#define STENCIL_WIDTH_LAPLACE_WS_D0 13

REAL constant SBP_minus_laplace_WS_D0[2*NUM_BOUNDS_LAPLACE_WS_D0+1][STENCIL_WIDTH_LAPLACE_WS_D0] = {
  // left boundary coefficients
  {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0},
  {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.1929821267275034, -0.011822411320332805, -0.3916523926584866, -0.06955630889486922, 0.0388082736623178, 0.017792172475900047, -0.0024213276712700365},
  {0.0, 0.0, 0.0, 0.0, 0.0, -0.025267381783122482, 0.4923405059457677, 0.08944292609231455, -0.3664543628401733, 0.06361354925823891, -0.013966503394504427, 0.000543759578738365, 0.0},
  {0.0, 0.0, 0.0, 0.0, -0.44158195662886157, 0.047184825860170476, 0.6772233282878781, -0.05951614465580208, -0.3602909090562304, 0.06134439469147603, -0.0018578463142299416, 0.0, 0.0},
  {0.0, 0.0, 0.0, -0.10387668394942672, -0.25606325917903044, -0.0788325917554475, 0.7932194832885601, -0.07469368177479231, -0.4503310304216657, 0.11646437617013958, -0.00752162467092892, 0.0, 0.0},
  {0.0, 0.0, 0.05295431747407875, 0.040613694770740116, -0.436033462200551, -0.06824634040243721, 0.8751079076515696, -0.11127041804399747, -0.4398323139303141, 0.10995807848257852, -0.0068723799051611575, 0.0, 0.0},
  {0.0, 0.02453219336868024, -0.009010334481593482, 0.07501908267478423, -0.4157743784344476, -0.11243721201098661, 0.8987428274901319, -0.11053459479684481, -0.4444444444444444, 0.1111111111111111, -0.006944444444444444, 0.0, 0.0},
  {-0.0033385736745185123, 0.0003508004504499591, -0.0022719912217770326, 0.10752735285986151, -0.4444444444444444, -0.11053459479684481, 0.9027057132384945, -0.1111111111111111, -0.4444444444444444, 0.1111111111111111, -0.006944444444444444, 0.0, 0.0},
  // central coefficients
  {0.0, 0.0, -0.006944444444444444, 0.1111111111111111, -0.4444444444444444, -0.1111111111111111, 0.9027777777777778, -0.1111111111111111, -0.4444444444444444, 0.1111111111111111, -0.006944444444444444, 0.0, 0.0},
  // right boundary coefficients
  {0.0, 0.0, -0.006944444444444444, 0.1111111111111111, -0.4444444444444444, -0.1111111111111111, 0.9027057132384945, -0.11053459479684481, -0.4444444444444444, 0.10752735285986151, -0.0022719912217770326, 0.0003508004504499591, -0.0033385736745185123},
  {0.0, 0.0, -0.006944444444444444, 0.1111111111111111, -0.4444444444444444, -0.11053459479684481, 0.8987428274901319, -0.11243721201098661, -0.4157743784344476, 0.07501908267478423, -0.009010334481593482, 0.02453219336868024, 0.0},
  {0.0, 0.0, -0.0068723799051611575, 0.10995807848257852, -0.4398323139303141, -0.11127041804399747, 0.8751079076515696, -0.06824634040243721, -0.436033462200551, 0.040613694770740116, 0.05295431747407875, 0.0, 0.0},
  {0.0, 0.0, -0.00752162467092892, 0.11646437617013958, -0.4503310304216657, -0.07469368177479231, 0.7932194832885601, -0.0788325917554475, -0.25606325917903044, -0.10387668394942672, 0.0, 0.0, 0.0},
  {0.0, 0.0, -0.0018578463142299416, 0.06134439469147603, -0.3602909090562304, -0.05951614465580208, 0.6772233282878781, 0.047184825860170476, -0.44158195662886157, 0.0, 0.0, 0.0, 0.0},
  {0.0, 0.000543759578738365, -0.013966503394504427, 0.06361354925823891, -0.3664543628401733, 0.08944292609231455, 0.4923405059457677, -0.025267381783122482, 0.0, 0.0, 0.0, 0.0, 0.0},
  {-0.0024213276712700365, 0.017792172475900047, 0.0388082736623178, -0.06955630889486922, -0.3916523926584866, -0.011822411320332805, 1.1929821267275034, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0},
  {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}
};

// coefficients for the narrow stencil operator using homogeneous Dirichlet boundary conditions
// have not been derived
#ifdef USE_LAPLACE_NARROW_STENCIL_DIRICHLET
#error "Error in include/4thOrderExtended.h: Coefficients of the narrow stencil operator using homogeneous Dirichlet boundary conditions have not been derived."
#endif

// coefficients for the wide stencil operator using the least norm solution
#define NUM_BOUNDS_LAPLACE_WS_LN 8
#define STENCIL_WIDTH_LAPLACE_WS_LN 15

REAL constant SBP_minus_laplace_WS_LN[2*NUM_BOUNDS_LAPLACE_WS_LN+1][STENCIL_WIDTH_LAPLACE_WS_LN] = {
  // left boundary coefficients
  {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.4320891111479956, 2.9410954190768464, -1.0479663445329093, -0.7851200490566449, 0.27563079322190515, 0.11397098245770279, -0.03212463728202283, 0.004366736524987037},
  {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.6812439099639596, 1.1929821267275034, -0.011822411320332805, -0.3916523926584866, -0.06955630889486922, 0.0388082736623178, 0.017792172475900047, -0.0024213276712700365, 0.0},
  {0.0, 0.0, 0.0, 0.0, 0.0, -0.5187941031761948, -0.025267381783122482, 0.4923405059457677, 0.08944292609231455, -0.3664543628401733, 0.06361354925823891, -0.013966503394504427, 0.000543759578738365, 0.0, 0.0},
  {0.0, 0.0, 0.0, 0.0, -0.20504072149980182, -0.44158195662886157, 0.047184825860170476, 0.6772233282878781, -0.05951614465580208, -0.3602909090562304, 0.06134439469147603, -0.0018578463142299416, 0.0, 0.0, 0.0},
  {0.0, 0.0, 0.0, 0.09534607130707347, -0.10387668394942672, -0.25606325917903044, -0.0788325917554475, 0.7932194832885601, -0.07469368177479231, -0.4503310304216657, 0.11646437617013958, -0.00752162467092892, 0.0, 0.0, 0.0},
  {0.0, 0.0, 0.03602175440333827, 0.05295431747407875, 0.040613694770740116, -0.436033462200551, -0.06824634040243721, 0.8751079076515696, -0.11127041804399747, -0.4398323139303141, 0.10995807848257852, -0.0068723799051611575, 0.0, 0.0, 0.0},
  {0.0, -0.010259806031946043, 0.02453219336868024, -0.009010334481593482, 0.07501908267478423, -0.4157743784344476, -0.11243721201098661, 0.8987428274901319, -0.11053459479684481, -0.4444444444444444, 0.1111111111111111, -0.006944444444444444, 0.0, 0.0, 0.0},
  {0.001394626477667735, -0.0033385736745185123, 0.0003508004504499591, -0.0022719912217770326, 0.10752735285986151, -0.4444444444444444, -0.11053459479684481, 0.9027057132384945, -0.1111111111111111, -0.4444444444444444, 0.1111111111111111, -0.006944444444444444, 0.0, 0.0, 0.0},
  // central coefficients
  {0.0, 0.0, 0.0, -0.006944444444444444, 0.1111111111111111, -0.4444444444444444, -0.1111111111111111, 0.9027777777777778, -0.1111111111111111, -0.4444444444444444, 0.1111111111111111, -0.006944444444444444, 0.0, 0.0, 0.0},
  // right boundary coefficients
  {0.0, 0.0, 0.0, -0.006944444444444444, 0.1111111111111111, -0.4444444444444444, -0.1111111111111111, 0.9027057132384945, -0.11053459479684481, -0.4444444444444444, 0.10752735285986151, -0.0022719912217770326, 0.0003508004504499591, -0.0033385736745185123,0.001394626477667735},
  {0.0, 0.0, 0.0, -0.006944444444444444, 0.1111111111111111, -0.4444444444444444, -0.11053459479684481, 0.8987428274901319, -0.11243721201098661, -0.4157743784344476, 0.07501908267478423, -0.009010334481593482, 0.02453219336868024, -0.010259806031946043, 0.0},
  {0.0, 0.0, 0.0, -0.0068723799051611575, 0.10995807848257852, -0.4398323139303141, -0.11127041804399747, 0.8751079076515696, -0.06824634040243721, -0.436033462200551, 0.040613694770740116, 0.05295431747407875, 0.03602175440333827, 0.0, 0.0},
  {0.0, 0.0, 0.0, -0.00752162467092892, 0.11646437617013958, -0.4503310304216657, -0.07469368177479231, 0.7932194832885601, -0.0788325917554475, -0.25606325917903044, -0.10387668394942672, 0.09534607130707347, 0.0, 0.0, 0.0},
  {0.0, 0.0, 0.0, -0.0018578463142299416, 0.06134439469147603, -0.3602909090562304, -0.05951614465580208, 0.6772233282878781, 0.047184825860170476, -0.44158195662886157, -0.20504072149980182, 0.0, 0.0, 0.0, 0.0},
  {0.0, 0.0, 0.000543759578738365, -0.013966503394504427, 0.06361354925823891, -0.3664543628401733, 0.08944292609231455, 0.4923405059457677, -0.025267381783122482, -0.5187941031761948, 0.0, 0.0, 0.0, 0.0, 0.0},
  {0.0, -0.0024213276712700365, 0.017792172475900047, 0.0388082736623178, -0.06955630889486922, -0.3916523926584866, -0.011822411320332805, 1.1929821267275034, 0.6812439099639596, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0},
  {0.004366736524987037, -0.03212463728202283, 0.11397098245770279, 0.27563079322190515, -0.7851200490566449, -1.0479663445329093, 2.9410954190768464, 3.4320891111479956, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}
};

REAL constant SBP_diff_adjoint[2*NUM_BOUNDS+1][STENCIL_WIDTH] = {
  // left boundary coefficients
  {0.0, 0.0, 0.0, 0.0, 0.0, -1.5655577299412915, -2.006698028441886, 0.17969802499047988, 0.34551679626695936, -0.031124203444273024, -0.05295031931257198},
  {0.0, 0.0, 0.0, 0.0, 0.4648100847546831, 0.0, -0.31822112431530714, -0.19343747460090951, 0.01748789837432497, 0.029360615787208586, 0.0},
  {0.0, 0.0, 0.0, -0.08895922679561, 0.680116299599615, 0.0, -0.6911055296415899, 0.10654199486276988, -0.006593538025184958, 0.0, 0.0},
  {0.0, 0.0, -0.09023462498760625, 0.21809773186831677, 0.3645866195553873, 0.0, -0.5149776612013978, 0.0225279347652999, 0.0, 0.0, 0.0},
  {0.0, 0.010766469472750029, -0.026116752329614308, -0.07444717053592571, 0.6821178348068156, 0.0, -0.6825798774651727, 0.09025949605114705, 0.0, 0.0, 0.0},
  {0.016735517732012817, -0.040062884094222144, 0.004209605405399509, -0.02726389466132439, 0.6236615676516715, 0.0, -0.6597484708954711, 0.08246855886193388, 0.0, 0.0, 0.0},
  // central coefficients
  {0.0, 0.0, 0.0, -0.08333333333333333, 0.6666666666666666, 0.0, -0.6666666666666666, 0.08333333333333333, 0.0, 0.0, 0.0},
  // right boundary coefficients
  {0.0, 0.0, 0.0, -0.08246855886193388, 0.6597484708954711, 0.0, -0.6236615676516715, 0.02726389466132439, -0.004209605405399509, 0.040062884094222144, -0.016735517732012817},
  {0.0, 0.0, 0.0, -0.09025949605114705, 0.6825798774651727, 0.0, -0.6821178348068156, 0.07444717053592571, 0.026116752329614308,-0.010766469472750029, 0.0},
  {0.0, 0.0, 0.0, -0.0225279347652999, 0.5149776612013978, 0.0, -0.3645866195553873, -0.21809773186831677, 0.09023462498760625, 0.0, 0.0},
  {0.0, 0.0, 0.006593538025184958, -0.10654199486276988, 0.6911055296415899, 0.0, -0.680116299599615, 0.08895922679561, 0.0, 0.0, 0.0},
  {0.0, -0.029360615787208586, -0.01748789837432497, 0.19343747460090951, 0.31822112431530714, 0.0, -0.4648100847546831, 0.0, 0.0, 0.0, 0.0},
  {0.05295031931257198, 0.031124203444273024, -0.34551679626695936, -0.17969802499047988, 2.006698028441886, 1.5655577299412915,0.0, 0.0, 0.0, 0.0, 0.0}
};
